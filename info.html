<?php

$login_contact = str_replace("-", "", $_COOKIE['login_contact']);

?>

<!DOCTYPE html>
<html>
<head>
	<meta name="code" charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=0,maximum-scale=10,user-scalable=yes"/>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="STATIC/js/common.js"></script>
	<script type="text/javascript" src="STATIC/js/swiper-bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
	<link rel="stylesheet" type="text/css" href="STATIC/css/swiper-bundle.min.css"/>
	<link rel="stylesheet" type="text/css" href="STATIC/css/style.css"/>
</head>
<style type="text/css">
	.info_menu{
		border: 1px solid #ebebeb;
		border-radius: 12px;
	}

</style>
<body>
	<?php include './header.html'; ?>
	<div id="container">
		<section class="aside_section">
			<div class="inner">
				<aside class="side_menu">
					<div class="sticky">
						<article class="info_menu">
							<ul>
								<li><a href="info_reserve.html">주문 내역</a></li>
								<li><a href="info_point.html">포인트</a></li>
								<li><a href="info_qna.html">문의 내역</a></li>
								<li class="active"><a href="info.html">내 정보 관리</a></li>
							</ul>
						</article>
					</div>
				</aside>
				<article class="content">
					<h1 class="ct_title">내 정보 관리</h1>
					<section class="account_modify">
						<article class="mofidy_area">
							<h5 class="title">회원 정보</h5>
							<div class="field_area max700">
								<form id="info_form">
									<div class="field">
										<label>아이디</label>
										<input type="text" name="edit_id" value="<?=$_COOKIE['login_id']?>" disabled>
									</div>
									<div class="field">
										<label>이름</label>
										<input type="text" name="edit_name" value="<?=$_COOKIE['login_name']?>" disabled>
									</div>
									<div class="field">
										<label>휴대전화</label>
										<div class="verify_">
											<input type="text" name="edit_contact" value="<?=$login_contact?>" disabled>
										</div>				
									</div>
								</form>
								
							</div>
							<!-- <div class="btn_area mt50">
								<button id="infoEditBtn" class="editBtn">계정 정보 저장</button>
							</div> -->
						</article>
			
						
						<article class="mofidy_area pwd">
							<h5 class="title">비밀번호 수정</h5>
							<div class="field_area max700">
								<form id="pwd_form">
									<div class="field">
										<label>기존 비밀번호</label>
										<input type="password" name="ex_password">
									</div>
									<div class="field">
										<label>새 비밀번호</label>
										<input type="password" name="new_password">
									</div>
									<div class="field">
										<label>새 비밀번호 확인</label>
										<input type="password" name="new_password2">
									</div>
								</form>
							</div>
							<div class="btn_area between mt50">
								<button id="pwdEditBtn" class="editBtn">비밀번호 변경</button>
								<a id="logoutBtn" class="cmain fwb">로그아웃</a>
							</div>
						</article>
					</section>
				</article>
			</div>
		</section>
	</div>
	<?php include './footer.html'; ?>
	<script type="text/javascript">
		// $( function(){
  //   		var select = new CustomSelectBox('.bank_');
  //   	})
		// // 전체보기
  //   	$('.drop_btn').click( function(){
		// 	var $this = $(this);
		// 	var $parent = $this.parents('li');
		// 	$this.toggleClass('active');
		// 	if($this.hasClass('active')){
		// 		$parent.find('.dorp_wrap').slideDown(300);
		// 	} else {
		// 		$parent.find('.dorp_wrap').slideUp(300);
		// 	}
		// })

	$("#infoEditBtn").click(function(){
		var formData = $("#info_form").serialize();
		$.ajax({
			type: "POST",
          	url: "./API/info_edit_api.php", // 실제 서버 엔드포인트로 교체
          	data: formData,
          	success: function (response) {
          		console.log(response);
            // 성공적으로 응답을 받았을 때의 처리;
            	if(response==1){
            		alert('정보가 변경되었습니다.');
            		location.reload();
            	}else{
            		alert('문제가 발생하였습니다. 관리자에게 문의하세요');
            	}
            	// $('#singup_form :input').val('');
          	},
          	error: function (error) {
            // 오류 발생 시의 처리
            	console.error("Error:", error);
          	}

		});
	});

	$("#pwdEditBtn").click(function(){
		var formData = $("#pwd_form").serialize();
		$.ajax({
			type: "POST",
          	url: "./API/pwd_edit_api.php", // 실제 서버 엔드포인트로 교체
          	data: formData,
          	success: function (response) {
          		console.log(response);
            // 성공적으로 응답을 받았을 때의 처리;
            	if(response==1){
            		alert('비밀번호가 변경되었습니다. 다시 로그인해주세요.');
            		location.href = './API/logout_api.php';
            	}else{
            		alert(response);
            	}
            	// $('#singup_form :input').val('');
          	},
          	error: function (error) {
            // 오류 발생 시의 처리
            	console.error("Error:", error);
          	}

		});

	});

	$("#logoutBtn").click(function(){
		location.href = './API/logout_api.php';
	});
	</script>
</body>
</html>