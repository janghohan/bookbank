<!DOCTYPE html>
<html>
<head>
	<meta name="code" charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=0,maximum-scale=10,user-scalable=yes"/>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="STATIC/js/swiper-bundle.min.js"></script>
	<link rel="stylesheet" type="text/css" href="STATIC/css/swiper-bundle.min.css"/>
	<link rel="stylesheet" type="text/css" href="STATIC/css/style.css"/>
</head>
<body>
	<?php include './header.html'; ?>
	<style type="text/css">
		.log_wrap h1{
			font-size: 28px;
			text-align: center;
			margin-bottom: 30px;
		}
		input[type="number"]::-webkit-outer-spin-button,
		input[type="number"]::-webkit-inner-spin-button {
		    -webkit-appearance: none;
		    margin: 0;
		}
		.field_alert{
			/*display: none;*/
		}
		.blue{
			color: #0000ff;
		}
		.field_area a{
			cursor: pointer;
		}
		.field_area .verify_ .btn.active{
			background: #eb5d3e;
    		color: #fff;
		}
	</style>
	<div id="container">
		<section class="log_wrap">
			<h1>회원가입</h1>
			<article class="form_area signup_area">
				<!-- <article class="useType_">
					<h5>회원유형선택</h5>
					<div class="check_wrap">
						<div class="check_">
							<input type="radio" name="usetype" checked>
							<label><img src="STATIC/img/icon/tool/checker.svg">리뷰어/인플루언서</label>
						</div>
						<div class="check_">
							<input type="radio" name="usetype">
							<label><img src="STATIC/img/icon/tool/checker.svg">광고주</label>
						</div>
					</div>
					<div class="sng_sign">
						<div class="tit"><span>SNS 간편가입</span></div>
						<ul>
							<li><a href=""><img src="STATIC/img/icon/asset/naver.svg"></a></li>
							<li><a href=""><img src="STATIC/img/icon/asset/kakao.svg"></a></li>
							<li><a href=""><img src="STATIC/img/icon/asset/direct.svg"></a></li>
						</ul>
					</div>
				</article> -->
				<article class="field_wrap">
					<h5>회원정보 입력</h5>
					<form id="singup_form" return>
						<div class="field_area">
							<div class="field">
								<label>아이디</label>
								<input type="text" name="user_id" placeholder="영문,숫자 조합 6자리 이상">
							</div>
							<div class="field_alert id_area">
								
							</div>
						</div>
						<div class="field_area">
							<div class="field">
								<label>비밀번호</label>
								<input type="password" name="user_pwd" placeholder="비밀번호(최소 8자 이상)">
							</div>
							<div class="field_alert pwd_area"></div>
						</div>
						<div class="field_area">
							<div class="field">
								<label>비밀번호 확인</label>
								<input type="password" name="user_pwd2" placeholder="비밀번호 확인">
							</div>
							<div class="field_alert pwdchk_area"></div>
						</div>
						<div class="field_area">
							<div class="field">
								<label>이름</label>
								<input type="text" name="user_name" placeholder="이름">
							</div>
						</div>
						<div class="field_area">
							<div class="verify_">
								<div class="field">
									<label>휴대전화번호</label>
									<input type="number" name="user_contact" placeholder="(-) 없이 입력해주세요.">
								</div>
								<a class="btn send_auth">인증번호 전송</a>
							</div>
						</div>
						<div class="field_area">
							<div class="verify_">
								<div class="field">
									<label>인증번호 입력</label>
									<input type="number" name="user_auth" placeholder="인증번호를 입력해주세요.">
								</div>
								<a class="btn chk_auth">인증하기</a>
							</div>
						</div>
					</form>
				</article>
				<article class="field_wrap">
					<h5>약관동의</h5>
					<article class="term_wrap">
						<ul>
							<li>
								<div class="term allCehck">
									<div class="checkbox_">
										<input type="checkbox" id="allCheck">
										<label>전체 약관에 모두 동의합니다.</label>
									</div>
								</div>
							</li>
							<li>
								<div class="term">
									<div class="checkbox_">
										<input type="checkbox" name="checkTrem">
										<label>저전마을 서비스 이용약관(필수)</label>
									</div>
									<div class="drop_btn">전체보기
										<img src="./STATIC/img/icon/tool/arrow_down_m.svg">
									</div>
								</div>
								<div class="dorp_wrap">
									<div class="text"><?= include './serviceinfo.html';?></div>
								</div>
							</li>
							<li>
								<div class="term">
									<div class="checkbox_">
										<input type="checkbox" name="checkTrem">
										<label>개인정보 수집 동의서(필수)</label>
									</div>
									<div class="drop_btn">전체보기
										<img src="./STATIC/img/icon/tool/arrow_down_m.svg">
									</div>
								</div>
								<div class="dorp_wrap">
									<div class="text"><?php include './personalinfo.html'; ?></div>
								</div>
							</li>
							<!-- <li>
								<div class="term">
									<div class="checkbox_">
										<input type="checkbox" name="checkTrem">
										<label>개인정보 이용약관 동의서(선택)</label>
									</div>
									<div class="drop_btn">전체보기
										<img src="./STATIC/img/icon/tool/arrow_down_m.svg">
									</div>
								</div>
								<div class="dorp_wrap">
									<div class="text">제 1 조(목적)

										이 약관은 (주)코팬글로벌(이하 ‘회사’)이 운영하는 위드뮤 온라인 몰(이하 ‘판매채널’이라 합니다)를 통하여 제공하는 전자상거래 서비스(이하 ‘서비스’라 함)와 관련하여 ‘회사’와 ‘이용자’(제2조에 정합니다)의 권리와 의무, 책임사항 및 ‘이용자’의 ‘서비스’ 이용절차에 관한 사항을 규정함을 목적으로 합니다.

										제 2 조(정의)

										이 약관은 (주)코팬글로벌(이하 ‘회사’)이 운영하는 위드뮤 온라인 몰(이하 ‘판매채널’이라 합니다)를 통하여 제공하는 전자상거래 서비스(이하 ‘서비스’라 함)와 관련하여 ‘회사’와 ‘이용자’(제2조에 정합니다)의 권리와 의무, 책임사항 및 ‘이용자’의 ‘서비스’ 이용절차에 관한 사항을 규정함을 목적으로 합니다.

										이 약관은 (주)코팬글로벌(이하 ‘회사’)이 운영하는 위드뮤 온라인 몰(이하 ‘판매채널’이라 합니다)를 통하여 제공하는 전자상거래 서비스(이하 ‘서비스’라 함)와 관련하여 ‘회사’와 ‘이용자’(제2조에 정합니다)의 권리와 의무, 책임사항 및 ‘이용자’의 ‘서비스’ 이용절차에 관한 사항을 규정함을 목적으로 합니다.
									</div>
								</div>
							</li> -->
						</ul>
					</article>
				</article>
				<article class="btn_area">
					<button class="submitBtn">회원가입</button>
				</article>
			</article>
		</section>
	</div>
	<?php include './footer.html'; ?>

	<script type="text/javascript">
		//각각의 동의 체크박스
		var indiviualCheck = $('input[name="checkTrem"]');
		var idDuplicationCheck = false;
		var pwdDuplicationCheck = false;
		var pwdLengthCheck = false;
		var authCheck = false;
		
		$('.drop_btn').click( function(){
			var $this = $(this);
			var $parent = $this.parents('li');
			$this.toggleClass('active');
			if($this.hasClass('active')){
				$parent.find('.dorp_wrap').slideDown(300);
			} else {
				$parent.find('.dorp_wrap').slideUp(300);
			}
		})

		//전체 동의 체크박스의 상태가 변경될 때
		$('#allCheck').change( function(){
			var check = $(this).is(':checked');
			if(check){
				$('input[name="checkTrem"]').prop("checked", true);
			}else{
				$('input[name="checkTrem"]').prop("checked", false);
			}
		});

		// 개별 동의 체크박스 중 하나라도 변경되면
		$('input[name="checkTrem"]').change( function(){
			var check = $(this).is(':checked');

			//하나가 해제되면 전체 체크박스 해제
			if(!check){
				$('#allCheck').prop("checked", false);
			}

			var allChecked = true;
		
			indiviualCheck.each(function (index, element) {
        	// 각 요소에 대한 조작 또는 이벤트 처리를 여기에 추가
		    	if(!$(element).is(':checked')) {
		    		allChecked = false;
		    	}
		    });

		    if(allChecked) {
		    	$('#allCheck').prop("checked", true);
		    }
		});

		//아이디 중복체크
		$("input[name='user_id']").on('focusout', function () {
        // 입력된 아이디 가져오기
	        var userid = $(this).val();

	        // 서버로 아이디 중복 여부 확인 요청
	        $.ajax({
	          	type: 'POST',
	          	url: './API/signup_check_duplicate.php', // 서버 측의 파일 경로 또는 URL
	          	data: { userid: userid },
	          	success: function (response) {
	            // 서버로부터의 응답 처리
	            	console.log(response);
	            	if(response) {
	            		idDuplicationCheck = true;
	            		$(".id_area").html('<p>이미 사용중인 아이디입니다.</p>');
	            	}else{
	            		idDuplicationCheck = false;
	            		$('.id_area').html('<p class="blue">사용가능한 아이디입니다.</p>');
	            	}
	          	},
	          	error: function () {
	            // 오류 처리
	            	$('#result').text('Error occurred.');
	          	}
	        });
	    });
		//비밀번호 길이 체크
		$("input[name='user_pwd']").on('focusout', function (){
	    	var password = $("input[name='user_pwd']").val();

	        // 비밀번호와 길이체크
	        if (password.length >= 8) {
	        	pwdLengthCheck = true;
	        } else {
	        	pwdLengthCheck = false;
	        	$('.pwd_area').html('<p>비밀번호는 최소 8자리 이상이어야 합니다.</p>');
	        }
	    });

		//비밀번호 일치 확인
	    $("input[name='user_pwd2']").on('focusout', function (){
	    	var password = $("input[name='user_pwd']").val();
		    var confirmPassword = $("input[name='user_pwd2']").val();

	        // 비밀번호와 확인 비밀번호를 비교
	        if (password === confirmPassword) {
	        	pwdDuplicationCheck = true;
	          	$('.pwdchk_area').html('<p class="blue">비밀번호가 일치합니다.</p>');
	        } else {
	        	pwdDuplicationCheck = false;
	          	('.pwdchk_area').html('<p>비밀번호가 일치하지 않습니다.</p>');
	        }
	    });


		$(".submitBtn").click(function (){
			var formData = $("#singup_form").serialize();

			var essentialCheck1 = $('input[name="checkTrem"]:lt(1)');
			var essentialCheck2 = $('input[name="checkTrem"]:lt(2):gt(0)');

			if(!essentialCheck1.is(':checked')) {
				alert('저전마을 서비스 이용약관에 동의해주세요.');
				return false;
			}else if(! essentialCheck2.is(':checked')){
				alert('개인정보 수집에 동의해주세요.')
				return false;
			}

			if(idDuplicationCheck) {
				alert('아이디를 확인해주세요.');
				return false;
			}
			if(!pwdLengthCheck){
				alert('비밀번호는 최소 8자리 이상이어야 합니다.');
				return false;
			}
			if(!pwdDuplicationCheck){
				alert('비밀번호 일치여부를 확인해주세요.');
				return false;
			}

			if(!authCheck){
				alert('휴대폰 인증을 완료해주세요.');
				return false;
			}
        // Ajax 요청
	        $.ajax({
	          	type: "POST",
	          	url: "./API/signup_create_api.php", // 실제 서버 엔드포인트로 교체
	          	data: formData,
	          	success: function (response) {
	            // 성공적으로 응답을 받았을 때의 처리;
	            	alert(response);
	            	$('#singup_form :input').val('');
	          	},
	          	error: function (error) {
	            // 오류 발생 시의 처리
	            	console.error("Error:", error);
	          	}
	        });
		})

		var authNumber;

		$(".send_auth").click(function (){
			$.ajax({
	          	type: "POST",
	          	dataType: 'json',
	          	url: "./API/sms_send_api.php", // 실제 서버 엔드포인트로 교체
	          	data: {receiverNumber : $("input[name='user_contact']").val()},
	          	success: function (response) {
	            // 성공적으로 응답을 받았을 때의 처리;
	            	console.log(response);
	            	if(response.result_code==1){
	            		alert('인증번호가 전송되었습니다.');
	            		authNumber = response.authNumber;
	            	}else{
	            		alert('문제가 발생했습니다. 관리자에게 문의해주세요.');
	            	}
	            	
	            	// $('#singup_form :input').val('');
	          	},
	          	error: function (error) {
	            // 오류 발생 시의 처리
	            	console.error("Error:", error);
	          	}
	        });
		});

		$(".chk_auth").click(function (){
			if($("input[name='user_auth']").val()==""){
				alert('인증번호를 입력해주세요.');

			}else if($("input[name='user_auth']").val()!=authNumber){
				alert('인증번호가 일치하지 않습니다.');
			}else{
				authCheck = true;
				alert('인증되었습니다.');
				$(this).addClass('active');
			}
		});
	</script>
</body>
</html>